# 字典

```javascript
class Dictionary {
  constructor (toStrFn = defaultToString) {
    this.toStrFn = toStrFn
    this.table = {}
  }
}

function defaultToString(item) {
  if (item === null) {
    return 'NULL'
  } else if (item === undefined) {
    return 'UNDEFINED'
  } else if (typeof item === 'string' || item instansof String) {
    return `${item}`
  }
  return item.toString()
}
```

## 检测一个键是否存在于字典中

```javascript
hasKey(key) {
  return this.table[this.toStrFn(key)] !== null
}
```

## 在字典和ValuePair类中设置键和值

```javascript
set(key, value) {
  if (key !== null && value !== null) {
    const tableKey = this.toStrFn(key)
    this.table[tableKey] = new ValuePair(key, value)
    return true
  }
  return false
}

class ValuePair {
  constructor(key, value) {
    this.key = key
    this.value = value
  }
  // 方便字典更简单地通过toString输出结果
  toString() {
    return `[#${this.key}: ${this.value}]`
  }
}
```

## 从字典中移除一个值

```javascript
remove(key) {
  if (this.hasKey(key)) {
    delete this.table[this.toStrFn(keu)]
    return true
  }
  return false
}
```

## 从字典中检索一个值

```javascript
get(key) {
  const valuePair = this.table[this.toStrFn(key)]
  return valuePair == null ? undefined : valuePair.value
}
```

`get`方法的另一种实现方式：

```javascript
get(key) {
  // 访问了两次`table`对象，比第一种方法消耗更多
  if (this.hasKey(key)) {
    return this.table[this.toStrFn(key)].value
  }
  return undefined
}
```

## keys, values和valuePairs方法

### 返回字典中所有键值对的数组。

```javascript
keyValue() {
  return Object.values(this.table)
}
```

另一种实现方式：

```javascript
keyValue() {
  const valuePairs = []
  for (const k in this.table) {
    // 对象的原型可能包含其他属性，所以还需要hasKey方法验证table对象中是否包含该属性
    if (this.hasKey(k)) {
      valuePairs.push(this.table[k])
    }
  }
  return valuePairs
}
```

### 返回字典中所有原始键名的数组

```javascript
keys() {
  return this.keyValues().map(valuePair => valuePair.key)
}
```

使用了`Array`类中的`map()`方法，可以迭代数组中每个值，并将其换成其它值。

另一种实现方式：

```javascript
const keys = []
const valuePairs = this.keyValues()
for (let i = 0; i < valuePairs.length; i++) {
  keys.push(valuePairs[i].key)
}
return keys
```

### 返回字典中所有值的数组

```javascript
values() {
  return this.keyValues().map(valuePair => valuePair.value)
}
```

## forEach方法

该方法可以迭代数据结构中每个值。之前学习的数据结构中都能使用这种逻辑创建该方法。

```javascript
forEach(callbackFn) {
  const valuePairs = this.keyValues()
  for (let i = 0; i < valuePairs.length; i++) {
    // 回调函数传入两个参数，分别为键和值
    const result = callbackFn(valuePairs[i].key, valuePairs[i].value)
    // 如果回调函数返回的值是false，就终止循环
    if (result === false) {
      break
    }
  }
}
```

## clear, size, isEmpty和toString方法

```javascript
size() {
  return Object.keys(this.table).length
  // return this.keyValues().length
}
isEmpty() {
  return this.size() === 0
}
clear() {
  this.table = {}
}
toString() {
  if (this.isEmpty) {
    return ''
  }
  const valuePairs = this.keyValues()
  let objString = `${valuePairs[0].toString()}`
  for (let i = 1; i < valuePairs.length; i++) {
    objString = `${objString},${valuePairs[i].toString()}`
  }
  return objSting
}
```

